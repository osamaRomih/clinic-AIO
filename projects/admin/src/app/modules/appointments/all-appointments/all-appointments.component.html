<div class="page-wrapper">

  <div class="breadcrumb">
    <li>
      <h4 class="page-title">View Appointment</h4>
    </li>
    <mat-icon>chevron_right</mat-icon>
    <li class="breadcrumb-item breadcrumb-icon d-flex align-items-center"><img src="/assets/images/home.svg" /></li>
    <mat-icon>chevron_right</mat-icon>
    <li class="breadcrumb-item">Appointment</li>
    <mat-icon>chevron_right</mat-icon>
    <li class="breadcrumb-item active">View</li>
  </div>


  <div class="materialTableHeader">
    <div class="left">
      <ul class="d-flex mb-0 list-unstyled ">
        <li class="ms-3 d-flex align-items-center">
          <h2>Appointments</h2>
        </li>
        <li class="tbl-search-box ms-2 position-relative">
          <label for="search-input">
            <mat-icon class="search-icon">search</mat-icon>
          </label>
          <input matInput type="search" (keyup)="applyFilter($event)" placeholder="Search" #input class="search-field"
            id="search-input">
        </li>
      </ul>
    </div>
    <div class="right">
      <button *ngIf="selection.hasValue()" mat-icon-button matTooltip="Delete selected" matTooltipPosition="below"
        class="btn-delete me-2" (click)="confirmBulkDelete()">
        <mat-icon color="warn">delete</mat-icon>
      </button>
      <button mat-icon-button matTooltip="Xlsx Dlownload" matTooltipPosition="below" class="btn-download"
        (click)="exportAsExcel()">
        <mat-icon class="file-download-icon">file_download</mat-icon>
      </button>
    </div>
  </div>

  <div class="overflow-auto">
    <div class="table-container">
      <table mat-table [dataSource]="dataSource">

        <!-- Checkbox Column -->
        <ng-container matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
              [indeterminate]="selection.hasValue() && !isAllSelected()">
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)">
            </mat-checkbox>
          </td>
        </ng-container>

        <ng-container matColumnDef="patientName">
          <th mat-header-cell *matHeaderCellDef> Patient Name </th>
          <td mat-cell *matCellDef="let element">
            <div class="patient-cell">
              <img class="avatar" [src]="'https://localhost:7096/'+element.imageUrl" [alt]="element.patientName">
              <span>{{element.patientName}}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="appointmentDate">
          <th mat-header-cell *matHeaderCellDef> Appointment Date </th>
          <td mat-cell *matCellDef="let element"> {{element.date | date: 'MM/dd/yyyy'}} </td>
        </ng-container>

        <ng-container matColumnDef="time">
          <th mat-header-cell *matHeaderCellDef> Time </th>
          <td mat-cell *matCellDef="let element">
            <div class="d-flex align-items-center gap-1">
              <mat-icon class="text-primary">schedule</mat-icon>
              <span>{{element.startTime}}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef> Email </th>
          <td mat-cell *matCellDef="let element">
            <div class="icon-cell">
              <div class="d-flex align-items-center gap-1">
                <mat-icon class="col-red material-symbols-outlined">mail</mat-icon>
                <span>{{element.email}}</span>
              </div>

            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="mobile">
          <th mat-header-cell *matHeaderCellDef> Mobile </th>
          <td mat-cell *matCellDef="let element">
            <div class="d-flex align-items-center gap-1">
              <mat-icon class="col-green">call</mat-icon>
              <span>{{element.phoneNumber}}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="gender">
          <th mat-header-cell *matHeaderCellDef> Gender </th>
          <td mat-cell *matCellDef="let element">
            <span
              [ngClass]="{'badge-solid-purple': element.gender == 'female','badge-solid-green':element.gender == 'male'}">
              {{element.gender}}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let element">
            <span>
              {{element.status}}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef> Address </th>
          <td mat-cell *matCellDef="let element">
            <div class="icon-cell d-flex align-items-center">
              <mat-icon class="col-blue">location_on</mat-icon>
              <span>{{element.address}}</span>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="visitType">
          <th mat-header-cell *matHeaderCellDef> Visit Type </th>
          <td mat-cell *matCellDef="let element"> {{element.visitType}} </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let element">
            <div class="d-flex gap-2">
              <button mat-icon-button class="col-red" (click)="delete(element.id)">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button class="col-red" (click)="update(element.id)">
              <mat-icon>edit</mat-icon>
            </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        <tr class="mat-row" *matNoDataRow>
          <td class="mat-cell" colspan="11">No data matching the filter "{{input.value}}"</td>
        </tr>
      </table>
    </div>
  </div>


  <mat-paginator [pageSizeOptions]="[5, 10, 20]" (page)="onPageChange($event)" [length]="totalItems"
    [pageSize]="pageSize" [pageIndex]="pageIndex" showFirstLastButtons aria-label="Select page">
  </mat-paginator>

</div>