<mat-card appearance="outlined">
  <mat-card-header>
    <div class="d-flex justify-content-between align-items-center w-100">
      <div>
        <mat-card-title>
          <h2 class="h5 fw-semibold">{{ 'PRESCRIPTION_DETAILS.INFO_TITLE' | translate }}</h2>
        </mat-card-title>
        <mat-card-subtitle class="text-muted text-sm">{{ 'PRESCRIPTION_DETAILS.INFO_SUBTITLE' | translate
          }}</mat-card-subtitle>
      </div>
      <div class="badge bg-success">{{ 'PRESCRIPTION_DETAILS.STATUS_ACTIVE' | translate }}</div>
    </div>
  </mat-card-header>
  <mat-card-content>
    <div class="py-3 border-bottom">
      <div class="row mb-3">
        <div class="col-12 col-md-6">
          <div class="text-sm fw-medium text-muted">{{ 'PRESCRIPTION_DETAILS.ID' | translate }}</div>
          <div class="fw-medium">{{prescription.id}}</div>
        </div>
        <div class="col-12 col-md-6">
          <div class="text-sm fw-medium text-muted">{{ 'PRESCRIPTION_DETAILS.PRESCRIBED_BY' | translate }}</div>
          <div class="fw-medium">Dr. Anas Awaad</div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-12 col-md-6">
          <div class="text-sm fw-medium text-muted">{{ 'PRESCRIPTION_DETAILS.ISSUE_DATE' | translate }}</div>
          <div class="fw-medium">{{prescription.date}}</div>
        </div>
        <div class="col-12 col-md-6">
          <div class="text-sm fw-medium text-muted">{{ 'PRESCRIPTION_DETAILS.DIAGNOSIS' | translate }}</div>
          <div class="fw-medium">{{prescription.diagnosis}}</div>
        </div>
      </div>
      <div class="row">
        <div class="col-12 col-md-6">
          <div class="text-sm fw-medium text-muted">{{ 'PRESCRIPTION_DETAILS.NEXT_VISIT' | translate }}</div>
          <div class="fw-medium">{{prescription.nextVisit}}</div>
        </div>
      </div>
    </div>

    <h3 class="mt-3 fw-medium mb-2 h5">{{ 'PRESCRIPTION_DETAILS.MEDICATIONS_TITLE' | translate }}</h3>
    <div class="py-2">
      @if(prescription.items.length === 0) {
      <p class="text-muted text-sm">{{ 'PRESCRIPTION_DETAILS.NO_MEDICATIONS' | translate }}</p>
      } @else {
      <div class="mat-elevation-z1 prescription-table-container overflow-x-auto">

        <table mat-table [dataSource]="dataSource" class="full-width-table">

          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_ID' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.id}} </td>
          </ng-container>

          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_MEDICINE_NAME' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
          </ng-container>

          <ng-container matColumnDef="dosage">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_DOSAGE' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.dosage}} </td>
          </ng-container>

          <ng-container matColumnDef="frequency">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_FREQUENCY' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.frequency}} </td>
          </ng-container>

          <ng-container matColumnDef="days">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_DURATION' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.days}} </td>
          </ng-container>

          <ng-container matColumnDef="instructions">
            <th mat-header-cell *matHeaderCellDef> {{ 'PRESCRIPTION_DETAILS.TABLE_INSTRUCTIONS' | translate }} </th>
            <td mat-cell *matCellDef="let element"> {{element.instructions || ('PRESCRIPTION_DETAILS.N_A' | translate)}}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
      }
    </div>

    <div>
      <h3 class="mt-3 fw-medium mb-2 h5">{{ 'PRESCRIPTION_DETAILS.NOTES_TITLE' | translate }}</h3>
      <p class="text-muted text-sm"
        [innerHTML]="sanitizer.bypassSecurityTrustHtml(prescription.notes || ('PRESCRIPTION_DETAILS.N_A' | translate))">
      </p>
    </div>

  </mat-card-content>
</mat-card>